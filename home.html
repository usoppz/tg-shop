<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <title>主页</title>
    <link rel="stylesheet" type="text/css" href="css/reset.css"/>
    <link rel="stylesheet" type="text/css" href="css/swiper.min.css"/>
    <link rel="stylesheet" type="text/css" href="icon/iconfont.css"/>
    <link rel="stylesheet" type="text/css" href="css/index.css"/>
	<link rel="stylesheet" type="text/css" href="css/item.css">
    <script src="js/jquery-3.5.1.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/swiper.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/utils/axios.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/home.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/utils/shopTool.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>

   <div id="main_content">
	<!-- banner -->
	<div class="banner_box">
		<div class="swiper-container">
			<div class="swiper-wrapper">
				<div class="swiper-slide"   v-for="item in swiperList" >
					<a :href="item.redirectUrl"><img :src="item.carouselUrl"></a>
				</div>
			</div>
			<!-- 如果需要分页器 -->
			<div class="swiper-pagination"></div>
		</div>
	</div>
	<div class="active">
		<ul class="active_list">
			<li>
				<a href="live.html" target="main">
					<img src="img/index/con1.png">
					<h1>春夏换新</h1>
				</a>
			</li>
			<li>
				<a href="live.html" target="main">
					<img src="img/index/con2.png">
					<h1>家纺床品</h1>
				</a>
			</li>
			<li>
				<a href="live.html" target="main">
					<img src="img/index/con3.png">
					<h1>家居家装</h1>
				</a>
			</li>
			<li>
				<a href="live.html" target="main">
					<img src="img/index/con4.png">
					<h1>收纳日用</h1>
				</a>
			</li>
			<li>
				<a href="live.html" target="main">
					<img src="img/index/con1.png">
					<h1>春夏换新</h1>
				</a>
			</li>
			<li>
				<a href="live.html" target="main">
					<img src="img/index/con2.png">
					<h1>家纺床品</h1>
				</a>
			</li>
			<li>
				<a href="live.html" target="main">
					<img src="img/index/con3.png">
					<h1>家居家装</h1>
				</a>
			</li>
			<li>
				<a href="live.html" target="main">
					<img src="img/index/con4.png">
					<h1>收纳日用</h1>
				</a>
			</li>
		</ul>
	</div>
	<!-- 推荐更多 -->
	<div class="recommend">
		<div style="padding: 4.67vw 3.33vw 2.27vw;font-size: 4.23vw;font-weight: bold;">
			<div style="text-align: center;color: #101010;margin-bottom: 1.87vw;">热门商品</div>
		</div>
		<div class="item_box">
			<div class="item"  v-for="item in hotGoodses" :key="item.goodsId" >
				<a :href="'detail.html?id='+item.goodsId" target="main">
					<div class="img_box">
						<img :src="prefix(item.goodsCoverImg)" alt="">
					</div>
					<div class="item_content">
						<div class="name">{{ item.goodsName }}</div>
						<div class="content_score">
							<div class="original"><img class="score_img" src="img/money.png" alt="">原价： <span style="text-decoration: line-through;">¥{{item.originalPrice}}</span></div>
							<div class="price">
								<div>到手价</div> ￥<span>{{ item.sellingPrice }}</span>
							</div>
						</div>
						<div class="content_earn">
							<div class="earn"><img class="earn_img" src="img/icon2.png" alt="">省￥<span v-text="discount(item.originalPrice,item.sellingPrice)"></span></div>
							<div class="percentage">折扣比例： <span v-text="discountRatio(item.originalPrice,item.sellingPrice)"></span></div>
						</div>
					</div>
				</a>
			</div>
		</div>
		<div style="padding-bottom:2.27vw;padding-right: 3.33vw; font-size: 4.23vw;font-weight: bold;">
			<div style="text-align: center;color: #101010;margin-bottom: 1.87vw;">新品上线</div>
		</div>
		<div class="item_box">
			<div class="item"  v-for="item in newGoodses" :key="item.goodsId" >
				<a :href="'detail.html?id='+item.goodsId" target="main">
					<div class="img_box">
						<img :src="prefix(item.goodsCoverImg)" alt="">
					</div>
					<div class="item_content">
						<div class="name">{{ item.goodsName }}</div>
						<div class="content_score">
							<div class="original"><img class="score_img" src="img/money.png" alt="">原价： <span style="text-decoration: line-through;">¥{{item.originalPrice}}</span></div>
							<div class="price">
								<div>到手价</div> ￥<span>{{ item.sellingPrice }}</span>
							</div>
						</div>
						<div class="content_earn">
							<div class="earn"><img class="earn_img" src="img/icon2.png" alt="">省￥<span v-text="discount(item.originalPrice,item.sellingPrice)"></span></div>
							<div class="percentage">折扣比例： <span v-text="discountRatio(item.originalPrice,item.sellingPrice)"></span></div>
						</div>
					</div>
				</a>
			</div>
			<div style="padding-top:4.67vw;padding-bottom:2.27vw;padding-right: 3.33vw; font-size: 4.23vw;font-weight: bold;">
				<div style="text-align: center;color: #101010;margin-bottom: 1.87vw;">店长推荐</div>
			</div>
			<div class="item_box">
				<div class="item"  v-for="item in recommendGoodses" :key="item.goodsId" >
					<a :href="'detail.html?id='+item.goodsId" target="main">
						<div class="img_box">
							<img :src="prefix(item.goodsCoverImg)" alt="">
						</div>
						<div class="item_content">
							<div class="name">{{ item.goodsName }}</div>
							<div class="content_score">
								<div class="original"><img class="score_img" src="img/money.png" alt="">原价： <span style="text-decoration: line-through;">¥{{item.originalPrice}}</span></div>
								<div class="price">
									<div>到手价</div> ￥<span>{{ item.sellingPrice }}</span>
								</div>
							</div>
							<div class="content_earn">
								<div class="earn"><img class="earn_img" src="img/icon2.png" alt="">省￥<span v-text="discount(item.originalPrice,item.sellingPrice)"></span></div>
								<div class="percentage">折扣比例： <span v-text="discountRatio(item.originalPrice,item.sellingPrice)"></span></div>
							</div>
						</div>
					</a>
				</div>
		</div>
	</div>
   </div>
<script src="https://cdn.jsdelivr.net/npm/vue@3.0.11/dist/vue.global.prod.js"></script>

<script>
	const { createApp, reactive, toRefs, ref, onMounted } = Vue;

	const app = createApp({
		setup() {
			const state = reactive({
				swiperList: [], // 轮播图列表
				hotGoodses: [],
				newGoodses: [],
				recommendGoodses: []
			})
			onMounted(async() => {
				/*showLoadingToast({
                    message: '加载中...',
                    forbidClick: true
                });*/
				initHome();
			})

			const initHome = () => {
                axios.get('/index-infos').then(response => {
					state.swiperList = response.data.data.carousels;
					state.hotGoodses = response.data.data.hotGoodses;
					state.newGoodses = response.data.data.newGoodses;
					state.recommendGoodses = response.data.data.recommendGoodses;
                })
            }
			const prefix = (url) => {
				if (url && url.startsWith('http')) {
					return url
				} else {
					url = `https://mallapi.dpaycoin.com${url}`
					return url
				}
			}
			const discount = (original,selling) => {
				if (original > selling){
					return original - selling
				}else {
					return 0;
				}
			}
			const discountRatio = (original,selling) => {
				if (original > selling){
					let ratio = selling / original * 100;
					return ratio.toFixed(0) + "%"
				}else {
					return "无折扣";
				}
			}

			return {
				...toRefs(state),
				prefix,
				discount,
				discountRatio
			}
		}
	});
	app.mount("#main_content");
</script>
</body>
</html>
